<div data-turbolinks="false">
<div class='row'>
  <div class='col-sm-3'>
    <div class="card mb-3">
      
      <h3 class="card-header"><%= truncate(@world.title, length: 60) %></h3> 
      <div class="card-body">
        <h5 class="card-title"><%= (@world.source) %></h5>

      </div>
      <%= link_to @world.title_url, target: :_blank do %>
      <% end %>
      <%= image_tag (@world.image_url if !@world.image_url.nil? ) %>
      <div class="card-footer text-muted">
        Story Published <%= time_ago_in_words(@world.created_at) %> ago
      </div>
    </div>
  </div>
</div>




<p id='the-message'></p>   

<%= render 'comments/form' %>



<% @comments.each do |comment| %>

<div class="card border-primary mb-3">
  <div class="card-header"><%= comment.user.email %></div>
  <div class="card-body">
    <h4 class="card-title"></h4>
    <p class="card-text"><%= comment.comment %></p>
  </div>
</div>
<p>
<%= link_to like_comment_path(comment), class: 'like-btn',  remote: true, method: :put do %>
<div>
<span> <p> <i class='fa fa-thumbs-up fa-3x'></i> </p> </span>
</div>
<% end %>
<span class='likes-count'><%= comment.get_upvotes.size %></span>



</p>
<p>From Data <%= comment.get_upvotes.size %></p>

<% end %>
<script>
  
  // Enable pusher logging - don't include this in production
  Pusher.logToConsole = true;

  var pusher = new Pusher('3b8fe903171ecd2c3a5e', {
    cluster: 'us2',
    encrypted: true
  });

  var channel = pusher.subscribe('my-channel2');
  channel.bind('my-event2', function(data) { 
 
    $("#up_vote").html( data.up_vote );    

    $("#down_vote").html(data.down_vote) ;    

  });


</script>

<script>
  
  // Enable pusher logging - don't include this in production
  Pusher.logToConsole = true;

  var pusher = new Pusher('3b8fe903171ecd2c3a5e', {
    cluster: 'us2',
    encrypted: true
  });

  var channel = pusher.subscribe('my-channel');
  channel.bind('my-event', function(data) {
    $("#the-message").append( '<p>' + data.user_email + ': ' +  data.comment + '</p>'); 

    // $("#user_email").append(); 
    $('#comment_comment').val('');   
  });


</script>


</div>
